@using Stardome.DomainObjects
@model Stardome.Models.ContentModel
@Scripts.Render("~/Scripts/jsTree")
@Styles.Render("~/Content/jsTree")
@if (Request.IsAuthenticated == false)
{
    Response.Redirect("~/Account/Login");

}
@if (Model.RoleId != (int)Enums.Roles.Admin && Model.RoleId != (int)Enums.Roles.Producer && Model.RoleId != (int)Enums.Roles.User)
{
    Response.Redirect("~/Account/Login");
}
    @section featured {
        <section class="featured">
            <div class="content-wrapper">
                <hgroup class="title">
                    <h1>@ViewBag.Message</h1>
                </hgroup>
            </div>
        </section>
    }
<html>
<head>
    <meta charset="utf-8"> 

    <script type="text/javascript">
    function openFile(file) {
        window.location = file;
    }
    $(document).ready(function () {
        $('#MainTree').fileTree({
            root:  '@Model.RootPath', 
            script: '../Scripts/jqueryFileTree.aspx',
            multiFolder: false
        }, function (file) {
            openFile(file);
        });
    });
    </script>

</head>
<body>   
    <div id="MainTree"></div>  
    @if (Model.RoleId == (int)Enums.Roles.Producer || Model.RoleId == (int)Enums.Roles.Admin)
    {
        <h2>Files</h2>
    
        using (Html.BeginForm("Upload",
                        "Producer",
                        FormMethod.Post,
                        new { enctype = "multipart/form-data" }))
        {
            <label for="file">Upload File</label>
            <input type="file" name="files" id="file" /><br><br>
            <input type="submit" value="Upload Selected File" />
            <br><br>
            @ViewBag.Message
        }
    }
</body>
</html>  